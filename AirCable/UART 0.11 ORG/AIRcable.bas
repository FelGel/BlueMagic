@INIT 45
@IDLE 192
@SLAVE 318
@MASTER 351
@PIN_CODE 210
@PIO_IRQ 142
@INQUIRY 380
@MESSAGE 0
@CONTROL 419
@SENSOR 112
@ALARM 220
@UART 427
@FTP 0
1 0.11UART
2 3110
3 3111
4 0016CFEF3BFB SHAHARMI
5 AIR
6 0050C2
7 0
8 D0000540
9 00000
10 AIRusb3
11 1234
12 K0000540
13 P00000000000
14 P00010000000
15 1152
16 120
20 000000000000
21 P0000000000000
22 00
23 1
24 0
37 $24="5
38 RETURN
39 00000
40 IF$0[E]>57THEN43
41 F=$0[E]-48;
42 RETURN
43 F=$0[E]-55;
44 RETURN
45 Z=$9[0]-48;
46 A=baud1152
47 IF$9[2]=48THEN49
48 PRINTU"@INIT\n\r
49 IF$8[0]#122THEN57
50 $0[0]=0
51 PRINTV$12
52 FORE=0TO7
53 GOSUB40
54 $8[E]=F+48
55 NEXTE
56 $8[8]=0
57 $0[0]=0;
58 PRINTV$10;
59 IF$23[0]=48THEN63
60 PRINTV" 
61 A=getuniq$39;
62 PRINTV$39;
63 A=name$0;
64 H=1
65 A=pioin($8[2]-48);
66 A=pioset($8[2]-48);
67 A=pioout($8[1]-48);
68 A=pioclr($8[1]-48);
69 A=pioout($8[0]-48)
70 A=pioout($8[3]-48)
71 A=pioset($8[3]-48)
72 A=pioout($8[4]-48)
73 A=pioset($8[4]-48)
74 A=pioout($8[5]-48)
75 A=pioset($8[5]-48)
76 A=pioin($8[6]-48)
77 A=pioirq$13
78 A=uartcfg136
79 A=nextsns6
80 A=zerocnt
81 IF$9[2]=48THEN83
82 PRINTU"Command Line ready
83 IF$3[0]#90THEN85
84 $3=$2;
85 W=0
86 A=pioclr($8[0]-48)
87 J=0
88 $3[3]=48;
89 IF$9[2]=48THEN91
90 GOSUB598
91 A=pioset($8[1]-48)
92 K=1
93 A=uartint
94 H=1
95 A=pioset($8[7]-48)
96 A=pioin($8[7]-48)
97 M=0
98 IFH=0THEN100
99 RESERVED
100 RETURN
101 B=readcnt
102 C=atoi$16
103 IFB<CTHEN110
104 GOSUB108
105 H=0
106 GOTO226
107 IF$9[3]=49THEN109
108 A=disable3
109 RETURN
110 ALARM30
111 GOTO226
112 IF$15[0]=48THEN117;
113 C=atoi$15;
114 IFC=0THEN117;
115 I=C;
116 GOTO867
117 C=sensor$0;
118 IFC<160THEN127;
119 IFC<450THEN129;
120 IFC<650THEN131;
121 IFC<810THEN133;
122 IFC<930THEN135;
123 IFC<1020THEN137;
124 IFC<1090THEN139;
125 I=321;
126 GOTO116;
127 I=1152;
128 GOTO116;
129 I=96;
130 GOTO116;
131 I=384;
132 GOTO116;
133 I=1152;
134 GOTO116;
135 I=576;
136 GOTO116;
137 I=48;
138 GOTO116;
139 I=192;
140 GOTO116;
141 RETURN
142 IF$9[2]=48THEN145;
143 PRINTU"PIO_IRQ\n\r
144 PRINTU$0
145 IF$0[$8[2]-48]=48THEN183
146 IFW=3THEN141
147 IFW#0THEN156
148 GOTO940
150 RETURN
151 A=modemctl1;
152 RETURN
153 A=modemctl0;
154 RETURN
155 IFW=2THEN179
156 B=status;
157 IFB<10000THEN159;
158 B=B-10000;
159 IFB>0THEN188;
160 IF$3[0]=48THEN170;
161 IF$3[0]>50THEN170;
162 ALARM0
163 IF$9[2]=48THEN165;
164 PRINTU"-> pair as master
165 $3[0]=51;
166 W=0;
167 B=zerocnt;
168 A=slave-1;
169 RETURN
170 ALARM0
171 IF$9[2]=48THEN173
172 PRINTU"-> pair as slave\n
173 $3[0]=49
174 W=0
175 A=zerocnt;
176 A=cancel
177 ALARM1
178 RETURN
179 IF$9[2]=48THEN181
180 PRINTU"Handled, ignore\n\r
181 W=0
182 RETURN
183 IF$9[2]=48THEN185
184 PRINTU"Button press\n\r
185 W=1
186 ALARM3
187 RETURN
188 IF$9[2]=48THEN190
189 PRINTU"Short, Connected
190 W=0
191 RETURN
192 IF$3[3]#48THEN846;
194 IFW#0THEN366;
195 IFK=1THEN200;
196 IFK=2THEN201;
197 A=pioset($8[5]-48);
198 GOTO220;
200 A=slave-1;
201 K=0;
202 RETURN
210 IF$9[2]=48THEN212
211 PRINTU"@PIN_CODE
212 IF$23[0]=50THEN215
213 $0=$11;
214 RETURN
215 A=getuniq$0
216 RETURN
220 IF$9[2]=48THEN222
221 PRINTU"@ALARM\n\r
222 IFW=1THEN270
223 IF$9[2]=48THEN225
224 GOSUB598
225 IFH=1THEN101
226 B=status;
227 IFB<10000THEN229;
228 B=B-10000;
229 IFB>0THEN242;
230 A=pioset($8[5]-48);
231 GOTO246
242 A=pioset($8[0]-48);
243 A=pioset($8[1]-48);
244 ALARM5
245 RETURN
246 A=uartcfg136
247 IF$3[3]#48THEN735
248 IF$3[0]=48THEN265
249 A=pioset($8[1]-48);
250 A=pioset($8[0]-48)
251 A=pioclr($8[0]-48);
252 IF$3[0]>50THEN257
253 IF$3[1]=48THEN310
254 A=pioset($8[0]-48)
255 A=pioclr($8[0]-48);
256 GOTO297;
257 FORB=0TO2
258 A=pioset($8[0]-48)
259 A=pioclr($8[0]-48)
260 NEXTB
261 IF$3[1]=48THEN310;
262 A=pioset($8[0]-48)
263 A=pioclr($8[0]-48);
264 GOTO299;
265 B=pioset($8[1]-48);
266 B=pioclr($8[0]-48);
267 A=slave-1;
268 K=2
269 RETURN
270 GOSUB919;
271 W=2
272 IF$39[3]=49THEN284
273 IF$39[4]=49THEN284
274 $3[0]=48
275 $3[1]=48
276 IF$9[2]=48THEN278
277 PRINTU"->Reboot\n\r
278 A=pioclr($8[0]-48);
279 A=pioclr($8[1]-48);
280 W=3
281 A=reboot
282 WAIT3;
283 RETURN
284 ALARM0
285 IF$9[2]=48THEN287
286 PRINTU"-> Discconnect\n\r
287 IF$3[0]=50THEN290
288 IF$3[0]=52THEN290
289 GOTO291;
290 $3[0]=($3[0]-1)
291 $7="0
292 GOTO276
293 IF$9[2]=48THEN295
294 PRINTU"Timeout\n\r
295 ALARM0;
296 GOTO265;
297 A=slave20;
298 GOTO302
299 B=$24[0]
300 IFB>48THEN304
301 A=inquiry6
302 ALARM8
303 RETURN
304 A=master$7
305 IF$3[1]=48THEN307
306 $24[0]=B-1
307 IFA=0THEN242
308 ALARM8
309 RETURN
310 IF$3[0]=50THEN316
311 IF$3[0]=52THEN304
312 B=readcnt
313 IFB>120THEN293
314 IF$3[0]=49THEN297
315 GOTO301;
316 A=slave-20;
317 GOTO302
318 IF$9[2]=48THEN321;
319 PRINTU"@SLAVE\n\r
321 IF$3[3]=50THEN344;
322 IF$3[0]>50THEN347;
323 IF$3[0]>48THEN325;
324 GOTO347
325 A=getconn$7
326 IF$3[1]=49THEN334
327 IF$3[0]=50THEN331
328 $3[0]=50
329 $4=$7
330 GOTO334
331 $0=$4
332 B=strcmp$7
333 IFB#0THEN347
334 A=nextsns1
335 B=pioset($8[1]-48)
336 B=pioset($8[0]-48)
337 A=pioset($8[4]-48)
338 A=pioclr($8[5]-48)
339 A=pioirq$14
340 IF$9[1]=49THEN349
341 ALARM0
342 C=link1
343 RETURN
344 PRINTU"\n\rCONNECTED\n\r
345 $3[3]=53
346 GOTO336
347 A=disconnect0
348 RETURN
349 C=shell
350 RETURN
351 IF$9[2]=48THEN354
352 PRINTU"@MASTER\n\r
354 IF$3[3]#52THEN359
355 $3[3]=54
356 A=pioset($8[1]-48);
357 A=pioset($8[0]-48);
358 GOTO367
359 IF$3[0]>50THEN362;
360 IF$3[0]>48THEN377;
361 IF$3[0]=48THEN377;
362 A=pioset($8[1]-48);
363 A=pioset($8[0]-48);
364 IF$3[3]=52THEN374
365 IF$3[1]=49THEN367
366 $3[0]=52
367 A=nextsns1
368 A=pioset($8[4]-48);
369 A=pioclr($8[5]-48);
370 A=link2
371 ALARM5
372 A=pioirq$14
373 GOTO37
374 PRINTU"\n\rCONNECTED\n\r
375 $3[4]=54
376 GOTO367
377 A=disconnect1
378 RETURN
379 001620138557 K700i
380 $379=$0
381 IF$9[2]=48THEN383
382 PRINTU"@INQUIRY\n\r
383 IF$3[3]#51THEN387
384 PRINTU"\n\rFound device: 
385 PRINTU$379
386 RETURN
387 $4=$379;
388 $379=$0[13];
389 IF$3[0]#51THEN391;
390 IF$3[2]=49THEN392;
391 RETURN
392 IF$9[2]=48THEN395;
393 PRINTU"found 
394 PRINTU$4
395 IF$5[0]=0THEN400;
396 $0[0]=0;
397 PRINTV$379;
398 B=strcmp$5;
399 IFB#0THEN407;
400 B=master$4;
401 IFB=0THEN408;
402 $7=$4;
403 ALARM8;
404 A=pioset($8[1]-48);
405 A=pioset($8[0]-48);
406 $24="5
407 RETURN
408 GOSUB410;
409 RETURN
410 IFJ=1THEN415;
411 J=1;
412 A=pioset($8[0]-48);
413 A=pioclr($8[1]-48);
414 RETURN
415 A=pioclr($8[0]-48);
416 A=pioset($8[1]-48);
417 J=0;
418 RETURN;
419 IF$0[0]<128THEN422
420 A=uartcfg$0[0]
421 RETURN
422 IF$0[0]=49THEN425;
423 A=pioset($8[5]-48);
424 RETURN;
425 A=pioclr($8[5]-48);
426 RETURN
427 IF$9[2]=48THEN429
428 PRINTU"@UART\n\r
429 A=uartint
430 $0[0]=0;
431 TIMEOUTU5
432 INPUTU$0;
433 A=strlen$0;
434 IF$0[A-3]#43THEN436
435 IF$0[A-1]=43THEN438
436 A=uartint;
437 RETURN
438 $3[3]=49
439 ALARM1
440 A=enable3
441 RETURN
442 R
444 A=1;
445 $443[0]=0;
446 UARTA;
447 IF$0[0]=13THEN455;
448 $442=$0;
449 PRINTU$0;
450 $0[0]=0;
451 PRINTV$443;
452 PRINTV$442;
453 $443=$0;
454 GOTO446;
455 RETURN
456 ALARM0
457 A=uartcfg136
458 A=pioclr($8[0]-48);
459 A=pioclr($8[1]-48);
460 $3[3]=49
461 H=0
462 A=enable3
463 PRINTU"\r\nAIRcable OS 
464 PRINTU"command line v
465 PRINTU$1
466 PRINTU"\r\nType h to 
467 PRINTU"see the list of 
468 PRINTU"commands
469 PRINTU"\n\rAIRcable> 
470 GOSUB704;
471 PRINTU"\n\r
472 IF$443[0]=104THEN619;
473 IF$443[0]=108THEN505;
474 IF$443[0]=110THEN634;
475 IF$443[0]=112THEN644;
476 IF$443[0]=99THEN648;
477 IF$443[0]=117THEN531;
478 IF$443[0]=100THEN674;
479 IF$443[0]=105THEN761;
480 IF$443[0]=115THEN833;
481 IF$443[0]=109THEN800;
482 IF$443[0]=111THEN684;
483 IF$443[0]=97THEN557;
484 IF$443[0]=101THEN495;
485 IF$443[0]=98THEN664;
486 IF$443[0]=122THEN491;
487 IF$443[0]=114THEN710;
488 IF$443[0]=107THEN717
489 PRINTU"Command not found
490 GOTO469;
491 PRINTU"Input settings: 
492 GOSUB444
493 $9=$443
494 GOTO469
495 PRINTU"Bye!!\n\r
496 GOSUB107;
497 $3[3]=48;
498 H=1
499 A=slave-1;
500 A=uartint
501 A=zerocnt
502 A=pioset($8[1]-48);
503 M=0
504 RETURN
505 PRINTU"Command Line v
506 PRINTU$1
507 PRINTU"\n\rName: 
508 PRINTU$10;
509 PRINTU"\n\rPin: 
510 PRINTU$11;
511 A=psget0;
512 PRINTU"\n\rClass: 
513 PRINTU$0;
514 PRINTU"Baud: 
515 GOSUB551
519 A=getaddr;
520 PRINTU"\n\rBT Address:
521 PRINTU$0
522 GOSUB919;
523 PRINTU"\n\rBT Status:
524 PRINTU$39;
525 PRINTU"\n\rName Filter:
526 PRINTU$5;
527 GOSUB598
528 GOTO469;
531 PRINTU"Enter new Baud Ra
532 PRINTU"te divide by 100,
533 PRINTU"or 0 for switches
534 PRINTU": 
535 GOSUB444
536 $15=$443
537 PRINTU"\n\r
538 PRINTU"Parity settings:\n
539 PRINTU"\r0 for none\n\r
540 PRINTU"1 for even\n\r
541 PRINTU"2 for odd: 
542 GOSUB704
543 A=$443[0]
544 $22[0]=A
545 PRINTU"\n\rStop Bits settin
546 PRINTU"gs:\n\r0 for 1 stop
547 PRINTU" bit\n\r1 for 2 stop
548 PRINTU" bits:
549 GOSUB704
550 GOTO469
551 IF$15[0]=48THEN555
552 PRINTU$15
553 PRINTU"00 bps
554 RETURN
555 PRINTU"External
556 RETURN
557 PRINTU"Select new mode\n
558 PRINTU"\r0: Manual\n\r1:
559 PRINTU" Service Slave\n
560 PRINTU"\r2: Service Mast
561 PRINTU"er\n\r3: Cable Sl
562 PRINTU"ave\n\r4: Cable M
563 PRINTU"aster\n\r\n\rMode:
565 PRINTU" 
566 GOSUB704;
567 IF$443[0]=48THEN575;
568 IF$443[0]=49THEN577;
569 IF$443[0]=50THEN579;
570 IF$443[0]=51THEN582;
571 IF$443[0]=52THEN584;
573 PRINTU"\n\rInvalid Option
574 GOTO469;
575 $3="0010
576 GOTO469;
577 $3="1110
578 GOTO469;
579 $3="3110
580 $7="0
581 GOTO469;
582 $3="1010
583 GOTO469;
584 $3="3010
585 $7="0
586 GOTO469;
588 A=$433[0];
589 $9[3]=A
590 RETURN
598 PRINTU"\n\rMode: 
599 IF$3[0]>52THEN617
600 IF$3[0]=48THEN615
601 IF$3[1]=48THEN604
602 PRINTU"Service - 
603 GOTO605;
604 PRINTU"Cable - 
605 IF$3[0]!51THEN608;
606 PRINTU"Slave
607 GOTO609;
608 PRINTU"Master
609 IF$3[0]=50THEN613;
610 IF$3[0]=52THEN613;
611 PRINTU"\n\rUnpaired
612 RETURN
613 PRINTU"\n\rPaired
614 RETURN
615 PRINTU"Idle
616 RETURN
617 PRINTU"Relay Mode Master
618 RETURN
619 PRINTU"h: help, l: list,\n
620 PRINTU"\rn: name, p: pin, 
621 PRINTU"k: name/pin setting
622 PRINTU"s,\n\rb: name filte
623 PRINTU"r\n\rc: class of d
624 PRINTU"evice, u: uart, d: 
625 PRINTU"date,\n\rs: slave, 
626 PRINTU"i: inquiry, m: mast
627 PRINTU"er, a: mode,\n\ro: 
628 PRINTU"obex, f: obexftp\n
629 PRINTU"\re: exit, r: reboot
630 GOTO469;
634 PRINTU"New Name: 
635 GOSUB444;
636 $10=$443;
637 $0[0]=0;
638 PRINTV$10;
639 PRINTV" 
640 A=getuniq$39;
641 PRINTV$39;
642 A=name$0;
643 GOTO469
644 PRINTU"New PIN: 
645 GOSUB444;
646 $11=$443;
647 GOTO469
648 PRINTU"Type the class of 
649 PRINTU"device as xxxx xxx
650 PRINTU"x: 
651 GOSUB444
652 $0[0]=0;
653 PRINTV"@0000 =
654 PRINTV$443;
655 $443=$0;
656 A=psget0;
657 $442=$0
658 $0[0]=0;
659 PRINTV$443;
660 $443=$442[17]
661 PRINTV$443;
662 A=psset3
663 GOTO469
664 PRINTU"Enter the new name
665 PRINTU" filter: 
666 GOSUB444
667 $5=$443
668 GOTO469;
669 PRINTU"Enter the new addr
670 PRINTU"ess filter: 
671 GOSUB444
672 $6=$443
673 GOTO469
674 PRINTU"Insert new dat
675 PRINTU"e, check the manua
676 PRINTU"l for formating: 
677 GOSUB444;
678 A=strlen$443
679 IFA#16THEN682
680 A=setdate$443
681 GOTO469
682 PRINTU"\n\rInvalid format
683 GOTO469
684 PRINTU"Obex/ObexFTP setti
685 PRINTU"ngs:\n\r0: Enabled 
686 PRINTU"only on command li
687 PRINTU"ne\n\r1: Always Ena
688 PRINTU"bled\n\r2: Always D
689 PRINTU"isabled\n\rChoose 
690 PRINTU"Option: 
691 GOSUB704
692 GOSUB588
693 IF$443[0]=50THEN699
694 $0[0]=0
695 A=psget6
696 $0[11]=48
697 A=psset3
698 GOTO469
699 $0[0]=0
700 A=psget6
701 $0[11]=54
702 A=psset3
703 GOTO469
704 A=1
705 $443[0]=0;
706 UARTA
707 PRINTU$0
708 $443=$0
709 RETURN
710 PRINTU"Rebooting, please 
711 PRINTU"do not disconnect 
712 PRINTU"electric power\n\r
713 $3[3]=48
714 A=reboot
715 WAIT2
716 RETURN
717 PRINTU"Name/Pin settings:\n
718 PRINTU"\r0: Don't add anyth
719 PRINTU"ing,\n\r1: Add uniq 
720 PRINTU"to the name,\n\r2: 
721 PRINTU"Add uniq to the nam
722 PRINTU"e, set pin to uniq: 
723 GOSUB704
724 IF$443[0]<48THEN728
725 IF$443[0]>50THEN728
726 $23=$443
727 GOTO469
728 PRINTU"Invalid Option\n\r
729 GOTO717
730 PRINTU"\n\rThere is BT
731 PRINTU"activity, please
732 PRINTU"wait and try agai
733 PRINTU"n
734 GOTO469;
735 IF$3[3]=50THEN744
736 IF$3[3]=51THEN748
737 IF$3[3]=52THEN754
738 IF$3[3]=49THEN456
739 IF$3[3]=54THEN741
740 RETURN
741 A=pioclr($8[0]-48);
742 A=pioclr($8[1]-48);
743 GOTO469
744 A=pioset($8[1]-48);
745 A=pioset($8[0]-48)
746 A=pioclr($8[0]-48)
747 GOTO846
748 A=pioset($8[0]-48);
749 A=pioset($8[1]-48)
750 A=pioclr($8[0]-48);
751 A=pioclr($8[1]-48);
752 GOTO846
753 A=zerocnt
754 A=pioset($8[0]-48);
755 A=pioset($8[1]-48)
756 A=pioclr($8[1]-48);
757 ALARM18
758 GOTO846
761 GOSUB919;
762 IF$39[0]=49THEN730
763 PRINTU"Inquirying for
764 PRINTU" 18s. Please wait.
765 A=nextsns20
766 B=inquiry6
767 $3[3]=51;
768 GOSUB919;
769 A=zerocnt
770 GOTO748;
800 GOSUB919;
801 IF$39[3]=49THEN730
802 PRINTU"Please input 
803 PRINTU"the addr of your 
804 PRINTU"peer:
805 GOSUB444
806 B=strlen$443
807 IFB#12THEN830
808 $3[3]=52;
809 A=nextsns20
810 B=master$443
811 B=zerocnt
812 GOTO754
830 PRINTU"Invalid add
831 PRINTU"r, try again.
832 GOTO469;
833 GOSUB919;
834 IF$39[4]=49THEN730
835 PRINTU"Slave Open for 16s
836 $3[3]=50
837 A=nextsns20
838 A=slave15
839 A=zerocnt
840 GOTO744
846 B=readcnt
847 IFB<16THEN854
848 $3[3]=49
849 A=cancel
850 A=disconnect1
851 A=pioclr($8[0]-48)
852 A=pioclr($8[1]-48)
853 GOTO469
854 ALARM18
855 RETURN
860 IF$3[3]>48THEN862
861 A=baudI
862 RETURN
863 IF$3[3]>48THEN865
864 A=uartcfgI
865 RETURN
867 IFI=12THEN882
868 IFI=24THEN884
869 IFI=48THEN886
870 IFI=96THEN888
871 IFI=192THEN890
872 IFI=384THEN892
873 IFI=576THEN894
874 IFI=769THEN896
875 IFI=1152THEN898
876 IFI=2304THEN900
877 IFI=4608THEN902
878 IFI=9216THEN904
879 IFI=13824THEN906
880 GOTO860
882 I=0
883 GOTO907
884 I=1
885 GOTO907
886 I=2
887 GOTO907
888 I=3
889 GOTO907
890 I=4
891 GOTO907
892 I=5
893 GOTO907
894 I=6
895 GOTO907
896 I=7
897 GOTO907
898 I=8
899 GOTO907
900 I=9
901 GOTO907
902 I=10
903 GOTO907
904 I=11
905 GOTO907
906 I=12
907 IF$22[0]=49THEN910
908 IF$22[0]=50THEN912
909 GOTO913
910 I=I+64
911 GOTO913
912 I=I+32
913 IF$22[1]=49THEN916
914 GOTO916
915 I=I+16
916 I=I+128
917 GOTO863
919 B=status
920 $39[0]=0;
921 $39="00000
922 IFB<10000THEN925;
923 $39[0]=49;
924 B=B-10000;
925 IFB<1000THEN928;
926 $39[1]=49;
927 B=B-1000;
928 IFB<100THEN931;
929 $39[2]=49;
930 B=B-100;
931 IFB<10THEN934;
932 $39[3]=49;
933 B=B-10;
934 IFB<1THEN936;
935 $39[4]=49;
936 $39[5]=0;
937 RETURN
940 IF$3[3]#48THEN944
941 IF$0[$8[6]-48]=48THEN151;
942 IF$0[$8[6]-48]=49THEN153;
943 RETURN
944 A=disconnect0
945 A=disconnect1
946 $3[3]=49
947 ALARM1
948 RETURN
